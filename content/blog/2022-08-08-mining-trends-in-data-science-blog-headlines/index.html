---
title: Mining Trends in Data Science Blog Headlines - Synonym Extraction with Shallow Transfer Learning from CommonSense Knowlege graph embeddings and Fasttext embeddings pretrained on 1.3 billion Google Queries  
author: Knut Jägersberg
date: '2022-08-08'
slug: []
categories:
  - Data Science
tags: []
---

<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<link href="{{< blogdown/postref >}}index_files/vis/vis-network.min.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/vis/vis-network.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/visNetwork-binding/visNetwork.js"></script>


<div id="mining-trends-in-data-science-blog-headlines---spawn-selectors" class="section level1">
<h1>Mining Trends in Data Science Blog Headlines - Spawn Selectors</h1>
<p>We’ll look at how to mine blog posts for learning about influence vectors of the data science bubble. A workflow for labeling text data in an ML supported way. It is based on the same process used for writing dictionaries in dictionary based labeling approaches and is utilizes semantic folding. Semantic folding is the utilization of self-supervised learning and massive pretrained models to journey through semantic space at superlogical velocity. We use model-intersubjectivity as gravity drive. Centering content around model core concepts which are related to one another but are from different perspectives yields semantic singularity: One models worldview is the dialectics of anothers ignorance. These intersubjective wormholes, a form of analogical reasoning, allow us to reason faster than possible by the rules of formal logic, in the realms of overlooked validity.<br />
Whilst we can do this across pretrained models from different domains to move around points of interest (i.e. warp Venus to the edge of Andromeda’s black hole and an earth alike planet to its place), there is more syntropy in defaulting to the language model in our head.</p>
<div class="figure">
<img src="https://www.youtube.com/watch?v=q5JJGX-Wppk" alt="" />
<p class="caption">s</p>
</div>
</div>
<div id="extracting-a-selector-graph-for-data-science-blog-post-titles" class="section level1">
<h1>Extracting a selector graph for data science blog post titles</h1>
<p>Peek into the scraped file:</p>
<pre class="r"><code>pacman::p_load(tidyverse, tidytable, data.table, tidytext, textrank, job, UBL, archetypes, future, future.callr, genieclust, doc2vec)


blogposts &lt;- fread(&quot;/home/knut/Desktop/my_niche/data/twds_scrape_distinct.csv&quot;)


blogposts[!duplicated(blogposts$variable),]</code></pre>
<pre><code>##           variable
##  1:         author
##  2:   author_motto
##  3: follower_count
##  4:          claps
##  5:           date
##  6:   reading_time
##  7:          title
##  8:       subtitle
##  9:             h1
## 10:        bullets
## 11:     paragraphs
## 12:           body
##                                                             value
##  1:                                                              
##  2:                                                       ·Feb 14
##  3:                                                 81K Followers
##  4:                                                              
##  5:                                                        Feb 14
##  6:                                                   21 min read
##  7: Stats Gist List: An Irreverent Statistician’s Guide to Jargon
##  8:                                                              
##  9: Stats Gist List: An Irreverent Statistician’s Guide to Jargon
## 10:                                                              
## 11:                                                       Sign In
## 12:</code></pre>
<p>Taking the number of titles as indication, this file contains 25k blog posts.</p>
<pre class="r"><code>titles &lt;- blogposts %&gt;% filter.(variable==&quot;title&quot;) %&gt;% distinct(value)
titles %&gt;% nrow()</code></pre>
<pre><code>## [1] 25240</code></pre>
<p>First, let’s extract keywords and keyphrases.</p>
<pre class="r"><code>#extract global keywords


# f &lt;- callr({
#   library(spacyr)
# 
#   
#   spacy_initialize(model = &quot;en_core_web_trf&quot;, python_executable = &quot;/home/knut/transformers/bin/python3&quot;)
# 
#   tags &lt;- spacy_parse(titles$value, entity = T, nounphrase = T)
#   
#   
# }, workers=1)


# pos_tags &lt;- value(f)
pos_tags &lt;- fst::read_fst(&quot;/home/knut/Desktop/pos_tags.fst&quot;)


keyw_nouns &lt;- textrank_keywords(pos_tags$lemma %&gt;% tolower(),
                          relevant = pos_tags$pos %in% c(&quot;NOUN&quot;),)
keyw_nouns &lt;- subset(keyw_nouns$keywords, ngram &gt; 0 &amp; freq &gt; 1)%&gt;% mutate(title=str_replace_all(keyword, &quot;-&quot;, &quot; &quot;))

keyw_nouns$title &lt;- str_squish(keyw_nouns$title)



keyw_verbs &lt;- textrank_keywords(pos_tags$lemma %&gt;% tolower(),
                          relevant = pos_tags$pos %in% c(&quot;VERB&quot;),)
keyw_verbs &lt;- subset(keyw_verbs$keywords, ngram &gt; 0 &amp; freq &gt; 1)%&gt;% mutate(title=str_replace_all(keyword, &quot;-&quot;, &quot; &quot;))

keyw_verbs$title &lt;- str_squish(keyw_verbs$title)


keyw_adjective &lt;- textrank_keywords(pos_tags$lemma %&gt;% tolower(),
                          relevant = pos_tags$pos %in% c(&quot;ADJ&quot;),)
keyw_adjective &lt;- subset(keyw_adjective$keywords, ngram &gt; 0 &amp; freq &gt; 1)%&gt;% mutate(title=str_replace_all(keyword, &quot;-&quot;, &quot; &quot;))

keyw_adjective$title &lt;- str_squish(keyw_adjective$title)



#extract local keywords


# job({
#   
#   library(tidyverse)
#   library(reticulate)
#   library(purrrgress)
#   use_python(&quot;/home/knut/transformers/bin/python3&quot;, required = T)
#   
#   kb &lt;- import(&quot;keybert&quot;)
#   
#   
#   kw_model &lt;- kb$KeyBERT(model = &#39;all-distilroberta-v1&#39;)
#   
# 
#   similar &lt;- function(doc){
#   kw_model$extract_keywords(doc, keyphrase_ngram_range=list(as.integer(1L), as.integer(3L)), use_mmr = T, diversity=as.numeric(0.7), top_n = as.integer(3L)) %&gt;% unlist()
#   
#   }
#   
#   
#   
#   res2 &lt;- purrrgress::pro_map(titles$value, similar) %&gt;% rlist::list.cbind() %&gt;% as.data.frame()
#   
#   
#   sims &lt;- res2 %&gt;% tidytable::pivot_longer.() %&gt;% mutate(check=as.numeric(value)) %&gt;% filter(!is.na(check))
#   
#   key &lt;- res2 %&gt;% tidytable::pivot_longer.() %&gt;% mutate(check=as.numeric(value)) %&gt;% filter(is.na(check))
#   
#   
#   keybert &lt;- data.table(keyword=key$value, cluster_similarity=sims$value, sentence=as.numeric(str_replace(key$name, &quot;V&quot;,&quot;&quot;))) %&gt;% distinct(keyword, sentence)%&gt;% inner_join.(titles %&gt;% mutate(sentence=row_number()))
#   
#   
#   
#   
#   
#   
# })
# 
# while(exists(&quot;keybert&quot;)==F) {
#   Sys.sleep(3)
# }

keybert &lt;- fst::read_fst(&quot;/home/knut/Desktop/keybert.fst&quot;)

keybert_counts &lt;- keybert %&gt;% group_by(keyword) %&gt;% count()


# f &lt;- callr({
#   library(spacyr)
# 
#   
#   spacy_initialize(model = &quot;en_core_web_trf&quot;, python_executable = &quot;/home/knut/transformers/bin/python3&quot;)
# 
#   tags &lt;- spacy_parse(keybert_counts$keyword, entity = T, nounphrase = T)
#   
#   
# }, workers=1)


# pos_tags_keybert &lt;- value(f)

pos_tags_keybert &lt;- fst::read_fst(&quot;/home/knut/Desktop/keybert_pos_tags.fst&quot;)


keybert_counts %&gt;% ungroup() %&gt;% sample_n(100)</code></pre>
<pre><code>## # A tibble: 100 × 2
##    keyword                              n
##    &lt;chr&gt;                            &lt;int&gt;
##  1 power intelligent results            1
##  2 sequencing data analysis             1
##  3 combining multiple models            1
##  4 design game levels                   1
##  5 predicting poetic movements          1
##  6 know gradient boosting               2
##  7 automatic identification parquet     1
##  8 observe                              1
##  9 data scientist title                 1
## 10 amazon emr cluster                   1
## # … with 90 more rows</code></pre>
<p>Next we want to make them comparable with word embeddings. Some of these phrases are pieces of sentences, yet, I’m first interested in words and keywords, because those yield a general and easiest to grasp grid to traverse.<br />
Thus, I choose non-contextual word embeddings for this task. I will use TransE embeddings trained on the CommonSense Knowledge Graph (CSKG, see <a href="https://github.com/usc-isi-i2/cskg" class="uri">https://github.com/usc-isi-i2/cskg</a>) to initialize doc2vec on both titles and blog posts themselves for quick hack to a complete, general grid of words with domain idiosyncrasies.</p>
<pre class="r"><code>#prepare the embeddings 

CSKG_labels &lt;- fread(&quot;/home/knut/nlpaug/cskg.tsv&quot;) %&gt;% select(`node1;label`, node1, `node2;label`, node2)</code></pre>
<pre><code>## Warning in fread(&quot;/home/knut/nlpaug/cskg.tsv&quot;): Found and resolved improper
## quoting out-of-sample. First healed line 32747: &lt;&lt;/c/en/ace/n/wn/person-
## mw:MayHaveProperty-/c/en/frame/n/wn/communication-0000 /c/en/ace/n/wn/person
## mw:MayHaveProperty /c/en/frame/n/wn/communication &quot;wizard of oz&quot; print framed
## may have property VG &gt;&gt;. If the fields are not quoted (e.g. field separator does
## not appear within any field), try quote=&quot;&quot; to avoid this warning.</code></pre>
<pre class="r"><code>CSKG_labels &lt;- CSKG_labels %&gt;% distinct(`node1;label`, node1) %&gt;%
  rename(label=`node1;label`, node=node1) %&gt;% 
  bind_rows.(CSKG_labels %&gt;% distinct(`node2;label`, node2)%&gt;%
               rename(label=`node2;label`, node=node2)) %&gt;% distinct.()

labels &lt;- splitstackshape::cSplit(CSKG_labels, &quot;label&quot;, &quot;|&quot;)</code></pre>
<pre><code>## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE</code></pre>
<pre><code>## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE

## Warning in type.convert.default(X[[i]], ...): &#39;as.is&#39; should be specified by the
## caller; using TRUE</code></pre>
<pre class="r"><code>labels &lt;- labels %&gt;% melt(id.vars=&quot;node&quot;, na.rm = T)


CSKG_embs &lt;- fread(&quot;/home/knut/nlpaug/embs/trans_log_dot_0.1.tsv&quot;) %&gt;% inner_join.(labels %&gt;% rename(V1=node, label=value) %&gt;% select(-variable))


CSKG_embs &lt;- CSKG_embs %&gt;% select.(-V1) %&gt;% distinct.()
names1 = make.names(CSKG_embs$label, unique=TRUE) %&gt;% str_replace_all(&quot;[.]&quot;, &quot;_&quot;) %&gt;% make.names(unique = T)

rownames(CSKG_embs) &lt;-  names1

CSKG_embs &lt;- CSKG_embs %&gt;% select.(-label)




#merge titles and posts for doc2vec 

paragraphs &lt;- blogposts %&gt;% filter.(variable==&quot;paragraphs&quot;) %&gt;% distinct(value) %&gt;% pull(value)

x &lt;- data.table(original=c(titles$value, paragraphs) %&gt;% unique()) %&gt;% mutate(doc_id=row_number())


ngrams &lt;- x %&gt;% unnest_ngrams(output = &quot;ngram&quot;, input = &quot;original&quot;, n = 3, n_min = 2, ngram_delim = &quot;_&quot;, drop = F)



#doc2vec for word embeddings

x$text   &lt;- tolower(x$original)
x$text   &lt;- gsub(&quot;[^[:alpha:]]&quot;, &quot; &quot;, x$text)
x$text   &lt;- gsub(&quot;[[:space:]]+&quot;, &quot; &quot;, x$text)
x$text   &lt;- str_squish(x$text)
x$nwords &lt;- txt_count_words(x$text)
x$text &lt;- stringr::word(x$text, start = 1, end = ifelse(x$nwords&lt;1000, x$nwords, 999)) </code></pre>
<pre><code>## Warning in stri_sub(string, from = start, to = end): argument is not an atomic
## vector; coercing</code></pre>
<pre class="r"><code>x &lt;- na.omit(x)


xs &lt;- subset(x, nwords &gt; 1 &amp; nchar(text) &gt; 0)


#replace ngram tokens

library(ngram)
bigrams &lt;- ngram(xs$text, n=2)
bigrams &lt;- get.phrasetable(bigrams)
bigrams$ngrams &lt;- str_replace_all(bigrams$ngrams %&gt;% str_squish(), &quot; &quot;, &quot;_&quot;)
bigrams &lt;- inner_join.(bigrams, data.table(ngrams=names1))

xs &lt;- subset(xs, nwords &gt; 2 &amp; nchar(text) &gt; 0)
trigrams &lt;- ngram(xs$text, n=3)
trigrams &lt;- get.phrasetable(trigrams)
trigrams$ngrams &lt;- str_replace_all(trigrams$ngrams %&gt;% str_squish(), &quot; &quot;, &quot;_&quot;)
trigrams &lt;- inner_join.(trigrams, data.table(ngrams=names1))


Replaces &lt;- data.frame(from = c(bigrams$ngrams %&gt;% str_replace_all(&quot;_&quot;, &quot; &quot;), trigrams$ngrams %&gt;% str_replace_all(&quot;_&quot;, &quot; &quot;)), to = c(bigrams$ngrams, trigrams$ngrams))

keyword_replaces &lt;- keyw_adjective %&gt;% filter.(ngram&gt;1) %&gt;% mutate(from=title, to=str_replace_all(title, &quot; &quot;, &quot;_&quot;)) %&gt;% select.(from, to) %&gt;% 
  bind_rows.(keyw_nouns %&gt;% filter.(ngram&gt;1) %&gt;% mutate(from=title, to=str_replace_all(title, &quot; &quot;, &quot;_&quot;)) %&gt;% select.(from, to), 
             keyw_verbs %&gt;% filter.(ngram&gt;1) %&gt;% mutate(from=title, to=str_replace_all(title, &quot; &quot;, &quot;_&quot;)) %&gt;% select.(from, to), 
             keybert_counts %&gt;% mutate(from=keyword, to=str_replace_all(keyword, &quot; &quot;, &quot;_&quot;)) %&gt;% select.(from, to)
    
  )


all_replacements &lt;- Replaces %&gt;% bind_rows.(keyword_replaces)



# library(disk.frame)
# # this will set up disk.frame with multiple workers
# setup_disk.frame()
# # this will allow unlimited amount of data to be passed from worker to worker
# options(future.globals.maxSize = Inf)
# 
# 
# text_df &lt;- as.disk.frame(x, outdir = &quot;/home/knut/Desktop/text_df/&quot;, overwrite = T)


library(tidytext)
unnest_unigrams&lt;-function(chunk){tidytext::unnest_ngrams(tbl = chunk, output=&quot;ngram&quot;, input=&quot;text&quot;, drop=F, n=1L)}
unnest_bigrams&lt;-function(chunk){tidytext::unnest_ngrams(tbl = chunk, output=&quot;ngram&quot;, input=&quot;text_clean&quot;, drop=F, n=2L)}
unnest_trigrams&lt;-function(chunk){tidytext::unnest_ngrams(tbl = chunk, output=&quot;ngram&quot;, input=&quot;text&quot;, drop=F, n=3L)}

#extract ngram tokens of knowledge graph

#not all of this code is at interactive data analysis speed, so I comment it out and use stored objects

# # text_df_unigrams&lt;-text_df %&gt;% cmap(unnest_unigrams) 
# # text_df_unigrams %&gt;% write_disk.frame(outdir  = &quot;/home/knut/Desktop/text_df_unigrams/&quot;, overwrite = T, compress = 100)
# text_df_unigrams &lt;- disk.frame(&quot;/home/knut/Desktop/text_df_unigrams/&quot;) %&gt;% collect()
# text_df_unigrams &lt;- text_df_unigrams %&gt;% mutate.(id=row_number.())
# 
# 
# 
# 
# 
# # text_df_trigrams&lt;-text_df %&gt;% cmap(unnest_trigrams) 
# # text_df_trigrams %&gt;% write_disk.frame(outdir  = &quot;/home/knut/Desktop/text_df_trigrams/&quot;, overwrite = T, compress = 100)
# # text_df_trigrams &lt;- disk.frame(&quot;/home/knut/Desktop/text_df_trigrams/&quot;)
# # text_df_trigrams &lt;- shard(df = text_df_trigrams, shardby = &quot;text&quot;, nchunks = 900, overwrite = T)
# # text_df_trigrams %&gt;% write_disk.frame(outdir  = &quot;/home/knut/Desktop/text_df_trigrams/&quot;, overwrite = T, compress = 100)
# 
# 
# # attach all keyword ngrams
# text_df_trigrams&lt;-disk.frame(&quot;/home/knut/Desktop/text_df_trigrams/&quot;) %&gt;% left_join(all_replacements %&gt;% rename(ngram=from), by=c(&quot;ngram&quot;=&quot;ngram&quot;)) %&gt;% collect() # %&gt;% mutate(ngram=ifelse(!is.na(to), to, ngram)) %&gt;% select(c(&quot;text&quot;, &quot;ngram&quot;)) %&gt;% collect() 
# 
# 
# text_df_trigrams2 &lt;- text_df_trigrams %&gt;% filter.(str_detect(to, &quot;_&quot;)) %&gt;% distinct.()
# 
# text_df_trigrams2 &lt;- text_df_trigrams2 %&gt;% unnest_tokens(output = &quot;unigram&quot;, input = &quot;ngram&quot;, drop = F) %&gt;% inner_join.(text_df_unigrams %&gt;% select.(-original, -nwords, -doc_id), by=c(&quot;text&quot;=&quot;text&quot;, &quot;unigram&quot;=&quot;ngram&quot;)) 
# 
# text_df_trigrams2 &lt;- text_df_unigrams %&gt;% left_join.(text_df_trigrams2 %&gt;% select.(text, doc_id, ngram=unigram, to))
# 
# #text_df_trigrams %&gt;% write_disk.frame(outdir = &quot;/home/knut/Desktop/text_df_trigrams2/&quot;, overwrite = T) 
# 
# 
# 
# # 
# # 
# # text_df_bigrams&lt;-disk.frame(&quot;/home/knut/Desktop/text_df_trigrams2/&quot;) %&gt;% cmap(unnest_bigrams) 
# # text_df_bigrams %&gt;% write_disk.frame(outdir  = &quot;/home/knut/Desktop/bigrams_twds/&quot;, overwrite = T, compress = 100)
# # text_df_bigrams &lt;- disk.frame(&quot;/home/knut/Desktop/bigrams_twds/&quot;)
# # text_df_bigrams = shard(text_df_bigrams, shardby = &quot;text_clean&quot;, outdir = &quot;/home/knut/Desktop/bigrams_twds2/&quot;, nchunks = 900, overwrite = T)
# 
# 
# 
# text_df_bigrams&lt;-disk.frame(&quot;/home/knut/Desktop/bigrams_twds/&quot;) %&gt;% collect()
# 
# 
# text_df_bigrams &lt;- text_df_bigrams %&gt;% left_join.(all_replacements %&gt;% rename(ngram=from), by=c(&quot;ngram&quot;=&quot;ngram&quot;))
# 
# 
# text_df_bigrams2 &lt;- text_df_bigrams %&gt;% filter.(str_detect(to, &quot;_&quot;)) %&gt;% distinct.()
# text_df_bigrams2 &lt;- text_df_unigrams %&gt;% left_join.(text_df_bigrams2 %&gt;% select.(text, ngram, to))
# 
# text_df_bigrams2 &lt;- text_df_bigrams2 %&gt;% unnest_tokens(output = &quot;unigram&quot;, input = &quot;ngram&quot;, drop = F) %&gt;% inner_join.(text_df_unigrams %&gt;% select.(-original, -nwords, -doc_id), by=c(&quot;text&quot;=&quot;text&quot;, &quot;unigram&quot;=&quot;ngram&quot;)) 
# 
# text_df_trigrams3 &lt;- text_df_trigrams2 %&gt;% left_join.(text_df_bigrams2 %&gt;% select.(text, unigram, bigram=to), by=c(&quot;text&quot;=&quot;text&quot;, &quot;ngram&quot;=&quot;unigram&quot;))
# 
# text_df_trigrams3 &lt;- text_df_trigrams3 %&gt;% distinct.()
# 
# 
# 
# 
# #now reduce bigrams and trigrams
# 
# text_df_trigrams3&lt;-text_df_trigrams3 %&gt;% mutate(ngram=ifelse(!is.na(bigram), bigram, ngram)) %&gt;% mutate(ngram=ifelse(!is.na(to), to, ngram)) %&gt;% select.(-to, -bigram) %&gt;% distinct.()
# text_df_trigrams3 &lt;- text_df_trigrams3 %&gt;% select.(-id) %&gt;% distinct.()
# 
# 
# #reconstruct data with ngrams
# 
# 
# doc2vecdata &lt;- text_df_trigrams3 %&gt;% 
#      summarise.(text_ngrams = str_c(ngram, collapse = &quot; &quot;), .by = c(original, text, doc_id))
# 
# 
# doc2vecdata$word_count &lt;- stringi::stri_count_words(doc2vecdata$text)
# 
# 
# doc2vecdata &lt;- doc2vecdata %&gt;% filter.(word_count&gt;4)



#finally got the trainingdata 

# d &lt;- doc2vecdata %&gt;% select.(doc_id, text=text_ngrams)

d &lt;- fst::read_fst(&quot;/home/knut/Desktop/doc2vectraindata.fst&quot;)

#rm(text_df_bigrams, ngrams, text_df_trigrams, toks_ngram, text_df_trigrams2, text_df_bigrams2)
gc()</code></pre>
<pre><code>##             used (Mb) gc trigger    (Mb)   max used    (Mb)
## Ncells  32187434 1719   87174095  4655.6   77077887  4116.5
## Vcells 737926375 5630 1812527760 13828.5 2265435782 17284.0</code></pre>
<pre class="r"><code>CSKG_embs2 &lt;- CSKG_embs %&gt;% as.matrix()
rownames(CSKG_embs2) &lt;- rownames(CSKG_embs)

doc2vec_CSKG_embs &lt;- paragraph2vec(d, type = &quot;PV-DM&quot;, threads = 15, embeddings = CSKG_embs2, dim = ncol(CSKG_embs), iter = 10, window = 10L, min_count = 3)

doc2vec_CSKG_words &lt;- as.matrix(doc2vec_CSKG_embs, which = &quot;words&quot;)



words &lt;- data.table(words=rownames(doc2vec_CSKG_words), id=1:length(rownames(doc2vec_CSKG_words))) %&gt;% filter(str_detect(words, &quot;python&quot;))


targets &lt;- doc2vec_CSKG_words[words$id,]

examples &lt;- paragraph2vec_similarity(targets, doc2vec_CSKG_words, top_n = 5) %&gt;% filter.(similarity&gt;0.7) %&gt;% filter.(term1!=term2)

examples</code></pre>
<pre><code>## # A tidytable: 163 × 4
##    term1                       term2                     similarity  rank
##    &lt;chr&gt;                       &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt;
##  1 well_python                 python_well                    0.944     2
##  2 visualizations_using_python rostami                        0.703     2
##  3 using_python_selenium       scraping_using_python          0.716     2
##  4 using_python_machine        calidad                        0.817     2
##  5 using_python_machine        dotson                         0.807     3
##  6 using_python_machine        stoeckl                        0.802     4
##  7 using_python_machine        anisdismail                    0.802     5
##  8 tips_python                 python_tips                    0.963     2
##  9 tips_python                 simple_tips                    0.780     3
## 10 tips_python                 data_science_introduction      0.724     4
## # … with 153 more rows</code></pre>
<p>Check out this graph plot here with similar terms for the word Python:</p>
<pre class="r"><code>node_labels &lt;- c(examples$term1, examples$term2) %&gt;% unique()

node_ids &lt;- 1:length(node_labels)




nodes &lt;- data.frame(id = node_ids,
                    
  # add labels on nodes
  label = node_labels,
  
  
  # size adding value
  #value = 1,          
  


  # control shape of nodes
  shape = rep(&quot;box&quot;, length(node_labels)))#,
  


relations_filtered_ids &lt;- examples %&gt;% inner_join.(nodes %&gt;% rename(term1=label)) 
relations_filtered_ids2 &lt;- examples %&gt;% inner_join.(nodes %&gt;% rename(term2=label)) 




edges &lt;- data.frame(from = relations_filtered_ids$id, 
                    to = relations_filtered_ids2$id, label=&quot;similarity&quot;)


library(tidygraph)</code></pre>
<pre><code>## 
## Attaching package: &#39;tidygraph&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre class="r"><code>g &lt;- tbl_graph(nodes = nodes, edges = edges, directed = FALSE)

g &lt;- g %&gt;% 
  activate(nodes) %&gt;% 
  mutate(degree = centrality_degree(), betweenness = centrality_betweenness()) %&gt;% 
  activate(edges) %&gt;% 
  mutate(betweenness = centrality_edge_betweenness()) %&gt;% 
  arrange(betweenness)</code></pre>
<pre><code>## Warning in betweenness(graph = graph, v = V(graph), directed = directed, :
## &#39;nobigint&#39; is deprecated since igraph 1.3 and will be removed in igraph 1.4</code></pre>
<pre class="r"><code>nodes2 &lt;- activate(g, nodes) %&gt;% as_tibble() %&gt;% mutate(value=degree*betweenness)





library(visNetwork)

visNetwork(nodes2, edges) %&gt;% 
   visOptions(highlightNearest = list(enabled = T, hover = F))</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173],"label":["well_python","visualizations_using_python","using_python_selenium","using_python_machine","tips_python","tensorflow_python","scratch_using_python","scratch_python","scraping_using_python","scikit_learn_python","reddit_python","realpythonproject","pythonlevel","pythonic","pythondatasciencehandbook","pythonanywhere","python_well","python_visualization_panel","python_visualization","python_virtual_environment","python_using_machine","python_tips","python_tensorflow","python_seaborn","python_scripts","python_script","python_scratch","python_python","python_plotly","python_pipeline","python_packages","python_opencv","python_oop","python_nlp","python_model","python_matplotlib","python_map","python_lists","python_library","python_libraries","python_learn","python_it","python_introduction","python_guide","python_functions","python_feature","python_example","python_environment","python_elasticsearch","python_dictionary","python_dictionaries","python_decorators","python_data_analytics","python_data_analysis","python_data","python_dash","python_class","python_best_practices","python_applications","python_analysis","python_algorithm","python_ai","python_a_guide","python","plotly_python","pipeline_python","opencv_python","open_source_python","oop_python","nlp_python","new_python_environment","model_python","map_python","manage_python","lists_python","learning_using_python","learning_python","learn_python_data","learn_python","language_python","ipython_magic_commands","ipython","introduction_python","install_python","implementations_python","guide_python","files_python","feature_python","example_python","elasticsearch_python","dictionaries_python","decorators_python","data_python","dash_python","cool_python_libraries","applications_python","analysis_python","algorithm_python","a_python_package","a_python_library","rostami","calidad","dotson","stoeckl","anisdismail","simple_tips","data_science_introduction","scratch_using","scikit_learn_library","praw","urllib","boyangzhao","appsilon","earthinversion","theaisummer","advancedtype","readable","jakevdp","niyogi","netlify","meta_programming","visualization_panel_app","visualization_package","virtual_environment","pipenv","venv","predict_student_grades","writing_advanced_sql","scripts","shell_commands","script","julia_language","julia","packages","libraries","in_libraries","library","functions","decorators","development_environment","virtualenv","dictionary","a_dictionary","data_analysis_library","plotly_dash","interactive_visualizations","base_class","gsitechnology","fbddb","salichon","aficionado","leiserson","abdel","munn","dunson","cython","visualization_using","excellent_tool","open_source_tool","runserver","locustfile","grisel","praxis","jupyter","install","install_tensorflow","equivalents","idan","katharina","awesomedata","rubanova","a_library","a_package"],"shape":["box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box"],"degree":[2,1,2,4,6,2,1,2,2,1,2,4,1,1,2,1,3,1,3,6,1,6,2,3,4,1,2,6,2,2,5,2,2,2,2,2,2,2,3,5,2,4,2,2,2,2,2,5,2,2,2,2,2,1,2,4,1,4,2,2,2,1,4,3,3,2,2,2,2,2,1,2,2,2,2,2,2,2,4,2,4,1,2,2,1,2,2,2,2,2,2,2,2,3,4,2,2,2,4,5,1,1,1,1,1,3,3,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1],"betweenness":[0,0,60,992.333333333333,1350,565.083333333333,0,128.916666666667,280,0,104,280,0,0,12,0,339,0,660,679,0,578.916666666667,83.0833333333333,232,33,0,81,299,81,33.5,186.5,5,5,10,12,2,118,118,8,448,174,232,118,228,0,1,60,215.583333333333,38.5833333333333,10.3333333333333,53.5833333333333,45.9166666666667,60,0,60,29,0,6,9,9,1,0,3,57,57,29,29,1,29,56,0,11.5,20.5,0,29,1,29,29,13,6,11,0,2,1,0,60,60,4,4,60,60,60,60,119,6,60,60,60,177,3,0,0,0,0,0,39.5,48.1666666666667,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"value":[0,0,120,3969.33333333333,8100,1130.16666666667,0,257.833333333333,560,0,208,1120,0,0,24,0,1017,0,1980,4074,0,3473.5,166.166666666667,696,132,0,162,1794,162,67,932.5,10,10,20,24,4,236,236,24,2240,348,928,236,456,0,2,120,1077.91666666667,77.1666666666667,20.6666666666667,107.166666666667,91.8333333333333,120,0,120,116,0,24,18,18,2,0,12,171,171,58,58,2,58,112,0,23,41,0,58,2,58,58,52,12,44,0,4,2,0,120,120,8,8,120,120,120,120,357,24,120,120,120,708,15,0,0,0,0,0,118.5,144.5,0,0,0,0,0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"edges":{"from":[1,2,3,4,4,4,4,5,5,5,5,6,7,8,9,10,11,11,12,12,12,12,13,14,15,15,16,17,17,18,19,19,20,20,20,20,21,22,22,22,22,23,24,24,25,25,25,26,27,28,28,28,28,29,30,31,31,31,31,32,33,34,35,36,37,38,39,39,40,40,40,40,41,42,42,43,44,45,45,46,47,48,48,48,48,49,50,50,51,52,53,54,55,56,56,56,57,58,58,58,58,59,60,61,62,63,63,63,63,64,64,65,65,66,67,68,68,69,70,71,72,73,74,74,75,76,76,77,78,79,79,80,81,81,81,82,83,84,84,85,86,87,88,89,90,91,92,93,94,94,95,95,95,95,96,97,98,99,99,99,100,100,100],"to":[1,3,5,5,6,8,9,17,19,20,20,22,22,23,24,25,27,28,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,42,43,44,46,47,48,49,51,52,53,55,56,59,60,61,64,65,66,67,69,70,72,73,75,77,78,79,79,80,81,83,86,87,88,89,90,91,92,93,94,96,97,98,99,100,100,101,102,103,104,105,106,106,106,107,107,107,108,109,110,111,112,113,113,114,115,116,117,118,119,120,121,122,123,124,124,125,126,127,128,129,130,131,132,133,134,134,135,135,136,136,137,138,139,140,141,142,143,144,145,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,172,173],"label":["similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity","similarity"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
<p>Now the same again for my pretrained fasttext embeddings. I felt like buying the Pastukhov databases for an affordable 500 euro and trained an ngram fasttext model on 1.3 billion English google queries. For the query data science, reasonable similar bigrams are suggested below:</p>
<pre class="r"><code>library(fastTextR)
library(wordVectors)

model &lt;- fastTextR::ft_load(&quot;/run/media/knut/HD/MLearningAlgoTests/data/Pastukhov_clean_english.bin&quot;)

ft_embs &lt;- ft_word_vectors(model, all_replacements$from) %&gt;% as.matrix() %&gt;% unique() %&gt;% as.VectorSpaceModel()


wordVectors::closest_to(matrix = ft_embs, ft_embs[[&quot;data science&quot;]], n = 1000) %&gt;% as.data.frame()  %&gt;% inner_join.(bigrams %&gt;% mutate(word=str_replace_all(ngrams, &quot;_&quot;, &quot; &quot;))) %&gt;% filter.(freq&gt;3)%&gt;% mutate(interest=`similarity to ft_embs[[&quot;data science&quot;]]`*prop) %&gt;% arrange.(desc(interest)) %&gt;% select.(-ngrams)</code></pre>
<pre><code>## # A tidytable: 27 × 5
##    word                `similarity to ft_embs[[&quot;data sc…`  freq    prop interest
##    &lt;chr&gt;                                            &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 data science                                     1     32227 9.34e-4  9.34e-4
##  2 data scientist                                   0.801 11006 3.19e-4  2.55e-4
##  3 computer science                                 0.766  1862 5.39e-5  4.13e-5
##  4 science project                                  0.764  1081 3.13e-5  2.39e-5
##  5 in science                                       0.782   230 6.66e-6  5.21e-6
##  6 science research                                 0.746   110 3.19e-6  2.38e-6
##  7 network science                                  0.798    38 1.10e-6  8.78e-7
##  8 information science                              0.756    36 1.04e-6  7.89e-7
##  9 new science                                      0.810    28 8.11e-7  6.57e-7
## 10 applied science                                  0.757    24 6.95e-7  5.26e-7
## # … with 17 more rows</code></pre>
<p>Projectiles have been spawned.</p>
<p>Gotta bounce.</p>
<div class="figure">
<img src="flakcanon.jpg" alt="" />
<p class="caption">ss</p>
</div>
<style type="text/css">

@import url(https://fonts.googleapis.com/css?family=Open+Sans:wght@300);

body{ /* Normal  */
      font-size: 16px;
      font-family: "Open Sans";
  }

td {  /* Table  */
  font-size: 8px;
}
h1.title {
  font-size: 20px;
  color: #324c63;
}
h1 { /* Header 1 */
  font-size: 30px;
  font-family: "Roboto";
}
h2 { /* Header 2 */
    font-size: 26px;
    font-family: "Roboto";
}
h3 { /* Header 3 */
  font-size: 22px;
  font-family: "Roboto";
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
    color: white;
    background-color: black;
}

p { /* Code block - determines code spacing between lines */
    font-size: 18px;
    font-family: "Open Sans";
    margin: 0px 0px 30px;
    padding: 10px;
    line-height: 200%;
}
</style>
</div>
